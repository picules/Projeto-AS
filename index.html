<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sistema de Dívidas - Responsivo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f0f2f5;
    }
    .container {
      max-width: 500px;
      margin: auto;
      padding: 20px;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
    h2 { text-align: center; }

    input, button, select {
      width: 100%;
      padding: 10px;
      margin: 5px 0 15px 0;
      font-size: 16px;
    }

    .item {
      border-bottom: 1px solid #ccc;
      padding: 10px 0;
    }

    .btn {
      background: #3498db;
      color: white;
      border: none;
      cursor: pointer;
    }

    .btn-danger {
      background: #e74c3c;
    }

    .paid {
      text-decoration: line-through;
      color: green;
    }

    .small {
      font-size: 12px;
      color: gray;
    }

    @media screen and (max-width: 600px) {
      .container { margin: 10px; }
    }
  </style>
</head>
<body>
  <div class="container" id="loginDiv">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Nome de usuário">
    <input type="password" id="password" placeholder="Senha">
    <button class="btn" onclick="login()">Entrar</button>
  </div>

  <div class="container" id="appDiv" style="display:none;">
    <h2>Controle de Dívidas</h2>
    <div>
      <input type="text" id="nome" placeholder="Nome do cliente">
      <input type="number" id="valor" placeholder="Valor da dívida">
      <button class="btn" onclick="adicionarDivida()">Adicionar</button>
    </div>
    <div id="lista"></div>
    <p class="small">* Somente o administrador (Vagner) pode excluir.</p>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCfHDdYAW8DkZ-XELvUWhUo3ln5rAu-1h8",
      authDomain: "adrjb-99601.firebaseapp.com",
      projectId: "adrjb-99601",
      storageBucket: "adrjb-99601.appspot.com",
      messagingSenderId: "688129341856",
      appId: "1:688129341856:web:c0a378171329e52c038cc5"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let usuarioLogado = "";

    function login() {
      const user = document.getElementById('username').value.trim().toLowerCase();
      const pass = document.getElementById('password').value.trim();

      if (!user) return alert("Informe um nome de usuário");

      usuarioLogado = user;

      document.getElementById('loginDiv').style.display = 'none';
      document.getElementById('appDiv').style.display = 'block';
    }

    function adicionarDivida() {
      const nome = document.getElementById('nome').value.trim();
      const valor = document.getElementById('valor').value.trim();

      if (!nome || !valor) return alert("Preencha todos os campos");

      const novaRef = db.ref('dividas').push();
      novaRef.set({
        nome: nome,
        valor: parseFloat(valor),
        pago: false
      });

      document.getElementById('nome').value = "";
      document.getElementById('valor').value = "";
    }

    db.ref('dividas').on('value', (snapshot) => {
      const dados = snapshot.val();
      const lista = document.getElementById('lista');
      lista.innerHTML = "";

      for (let id in dados) {
        const item = dados[id];
        const div = document.createElement('div');
        div.className = 'item';

        const status = item.pago ? 'paid' : '';
        div.innerHTML = `
          <strong class="${status}">${item.nome}</strong> - 
          <span class="${status}">R$ ${item.valor.toFixed(2)}</span><br>
          <button class="btn" onclick="marcarPago('${id}')">Marcar como pago</button>
          ${usuarioLogado === 'vagner' ? `<button class="btn btn-danger" onclick="excluir('${id}')">Excluir</button>` : ''}
        `;

        lista.appendChild(div);
      }
    });

    function marcarPago(id) {
      db.ref('dividas/' + id).update({ pago: true });
    }

    function excluir(id) {
      if (confirm("Tem certeza que deseja excluir?")) {
        db.ref('dividas/' + id).remove();
      }
    }
  </script>
</body>
</html>
